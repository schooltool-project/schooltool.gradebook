<tal:tag condition="view/update" />
<html metal:use-macro="context/@@standard_macros/page"
      i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" i18n:translate="">
    Gradebook
  </title>
</head>
<body>
<div metal:fill-slot="body">

  <div class="topmenu">
    <ul>
      <li tal:attributes="class section/css" 
          tal:repeat="section view/getSections">
        <a tal:attributes="href section/url" 
           tal:content="structure section/title"/>
      </li>
    </ul>
  </div>
  <br />
  <form method="post"
        tal:attributes="action string:${context/@@absolute_url}">
    <label for="currentWorksheet" i18n:translate="">Worksheet</label>
    <select name="currentWorksheet"
            onchange="this.form.submit()">
      <tal:block repeat="worksheet context/worksheets">
        <option value="1"
            tal:condition="python:worksheet != view.getCurrentWorksheet()"
            tal:attributes="value worksheet/title"
            tal:content="worksheet/title" />
        <option value="1" selected="selected"
            tal:condition="python:worksheet == view.getCurrentWorksheet()"
            tal:attributes="value worksheet/title"
            tal:content="worksheet/title" />
      </tal:block>
    </select>
    <a class="button-ok" title="View Final Grades"
       tal:attributes="href string:${context/@@absolute_url}/final.html">
       View Final Grades
    </a>
    <br /><br />
  </form>

  <table class="grades" border="1">
    <tr>
     <th>
       <div i18n:translate="">Name</div>
       <a href="?sort_by=student" i18n:translate="">(sort)</a>
     </th>
     <th>
       <div i18n:translate="">Average</div>
       <a tal:condition="nothing" href="?sort_by=average" i18n:translate="">(sort)</a>
     </th>
     <th tal:repeat="activity view/activities">
       <div>
         <a href=""
            tal:attributes="href
                string:gradeActivity.html?activity=${activity/hash}"
            tal:content="activity/title">
           HW 1
         </a>
       </div>
       <a href="?sort_by="
          tal:attributes="href
              string:${request/URL}?sort_by=${activity/hash}"
          i18n:translate="">
         (sort)
       </a>
       <div tal:content="activity/max" />
     </th>
    </tr>
    <tr tal:repeat="row view/table">
      <td>
        <a href=""
           tal:attributes="href
               string:gradeStudent.html?student=${row/student/id}"
           tal:content="row/student/title">
          Tom Hoffman
        </a>
      </td>
      <td>
	    <tal:if condition="row/average|nothing">
	      <b><span tal:replace="row/average" />%</b>
	    </tal:if>
      </td>
      <td tal:repeat="grade row/grades">
        <a href=""
           tal:attributes="href
        string:grade.html?student=${row/student/id}&activity=${grade/activity}"
           tal:content="grade/value" />
      </td>
    </tr>
    <tr tal:condition="nothing" class="Statistic" tal:repeat="stat view/statistics">
      <td class="name"
          tal:content="stat/name">
        Quantity
      </td>
      <td class="value"
          tal:repeat="value stat/values"
          tal:content="value">
        50.0 %
      </td>
    </tr>
  </table>

</div>
</body>
</html>
